import{r as u,R as e}from"./index-C2KC86Ta.js";import{c as w}from"./client-DCM6oUEP.js";import{u as T}from"./useAxiosAuth-JGr_IZ3E.js";import{a as K}from"./index-B9ygI19o.js";const O=()=>{const{axiosInstance:o,csrfLoaded:i}=T(),[n,d]=u.useState({serviciosHabilitados:{nombre:"Servicios Habilitados",clases:"bg-blue-200 text-blue-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/servicios-habilitados",localStorageKey:"servicios_habilitados_data",endpoint:"/api/servicios-habilitados",dataKey:"data"},viasIngreso:{nombre:"Vías de Ingreso",clases:"bg-green-200 text-green-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/via-ingreso",localStorageKey:"vias_ingreso_data",endpoint:"/api/via-ingreso",dataKey:"data"},diagnosticos:{nombre:"Diagnósticos",clases:"bg-stone-200 text-stone-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/cie10",localStorageKey:"default_cies_data",endpoint:"/api/cie10",dataKey:"data"},finalidades:{nombre:"Finalidades",clases:"bg-yellow-200 text-yellow-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/finalidades",localStorageKey:"finalidad_consulta_data",endpoint:"/api/finalidades",dataKey:"data.finalidades"},causasExternas:{nombre:"Causas Externas",clases:"bg-purple-200 text-purple-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/causa-atencion",localStorageKey:"causas_externas_data",endpoint:"/api/causa-atencion",dataKey:"data.causas_externas"},tiposAtencion:{nombre:"Modalidades de Atención",clases:"bg-teal-200 text-teal-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/modalidades-atencion",localStorageKey:"tipos_atencion_data",endpoint:"/api/modalidades-atencion",dataKey:"data.modalidades_atencion"},tiposAfiliacion:{nombre:"Tipos de Afiliación",clases:"bg-pink-200 text-pink-900",datos:[],visibles:[],activos:[],todos:[],activo:!1,activeChange:"api/tipos-afiliacion",localStorageKey:"tipos_afiliacion_data",endpoint:"/api/tipos-afiliacion",dataKey:"data"}}),[s,y]=u.useState(""),[a,E]=u.useState("todos"),_=(t,r)=>r.split(".").reduce((m,l)=>m&&m[l],t)||[];u.useEffect(()=>{if(!i)return;(async()=>{try{const m=Object.keys(n).map(c=>o.get(n[c].endpoint).then(v=>({key:c,data:_(v.data,n[c].dataKey)})).catch(v=>(console.error(`Error al cargar ${n[c].nombre}:`,v),{key:c,data:[]}))),l=await Promise.allSettled(m);d(c=>{const v={...c};return l.forEach(x=>{if(x.status==="fulfilled"){const{key:N,data:h}=x.value,S=h;v[N].datos=S,v[N].todos=S,v[N].activos=S.filter(k=>k.activo),v[N].visibles=S}}),v})}catch(r){console.error("Error al inicializar los datos:",r)}})()},[i]),u.useEffect(()=>{const t=Object.keys(n).find(r=>n[r].activo);t&&g(t)},[a,s]);const C=(t,r,m)=>{const l=r.toLowerCase();return t.nombre&&t.nombre.toLowerCase().includes(l)||t.descripcion&&t.descripcion.toLowerCase().includes(l)||(m?t.grupo&&t.grupo.toLowerCase().includes(l)||t.codigo==parseInt(l):t.codigo&&t.codigo.toLowerCase().includes(l))},g=t=>{d(r=>{const m=r[t].datos;let l;return a==="activos"?l=m.filter(c=>c.activo):a==="inactivos"?l=m.filter(c=>!c.activo):l=m,s&&(l=l.filter(c=>C(c,s,t==="serviciosHabilitados"))),{...r,[t]:{...r[t],visibles:l}}})},I=t=>{d(r=>{const m={};return Object.keys(r).forEach(l=>{m[l]={...r[l],activo:l===t?!r[l].activo:!1}}),m})},p=async(t,r)=>{const m=n[r],l=`${window.location.origin}/${m.activeChange}/${t.codigo}/activar`;try{const c=await o.patch(l);if(c.status<200||c.status>=300)throw new Error("Error en la respuesta del servidor");d(v=>{const x={...v};x[r]={...v[r],datos:v[r].datos.map(h=>h.codigo===t.codigo?{...h,activo:!h.activo}:h)};const N=x[r].datos;return x[r].todos=N,x[r].activos=N.filter(h=>h.activo),localStorage.setItem(x[r].localStorageKey,JSON.stringify(x[r].activos)),g(r),x})}catch(c){console.error("Error:",c)}},f=Object.keys(n).find(t=>n[t].activo),b=f?n[f]:null;return e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex flex-wrap gap-2 mb-4"},Object.keys(n).map(t=>e.createElement("button",{key:t,onClick:()=>I(t),className:`px-4 py-2 rounded ${n[t].activo?n[t].clases:"bg-gray-200 text-white"}`},n[t].nombre))),e.createElement("input",{type:"text",placeholder:"Buscar...",className:"w-full p-2 mb-4 border rounded",value:s,onChange:t=>y(t.target.value)}),b&&e.createElement("div",{className:"mb-4"},e.createElement("button",{className:"bg-cyan-500 text-white font-bold py-2 px-4 rounded mr-2",onClick:()=>E("activos")},"Activos (",b.activos.length,")"),e.createElement("button",{className:"bg-yellow-500 text-white font-bold py-2 px-4 rounded mr-2",onClick:()=>E("inactivos")},"Inactivos (",b.todos.length-b.activos.length,")"),e.createElement("button",{className:"bg-purple-500 text-white font-bold py-2 px-4 rounded mr-2",onClick:()=>E("todos")},"Todos (",b.todos.length,")")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},b?.visibles.map(t=>e.createElement("div",{key:t.codigo,className:"border p-2 mb-2 bg-pink-50 dark:bg-gray-800 rounded shadow"},e.createElement("h3",{className:"font-bold col-span-4"},t.nombre||"Sin nombre"),e.createElement("p",null,t.codigo||"Sin código"),e.createElement("button",{className:`mt-2 px-4 py-2 rounded ${t.activo?"bg-red-500":"bg-green-500"} text-white font-bold`,onClick:r=>{r.stopPropagation(),f&&p(t,f)}},t.activo?"Desactivar":"Activar")))))};function j(o){const[i,n]=u.useState(0),[d,s]=u.useState(o.authUser.nombre==="luis");function y(){n(i+1),s(!d)}return e.createElement("div",null,[e.createElement("h1",null,"React Test Component - Count: "+i),e.createElement("p",null,"Login User: "+o.loginUser),e.createElement("p",null,"Register User: "+o.registerUser),e.createElement("button",{className:d?"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors duration-300":"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-green-600 transition-colors duration-300",onClick:()=>y()},"Click Me")])}function D(o){const[i,n]=u.useState(!1),d=()=>{n(s=>!s)};return e.createElement("div",{className:"relative inline-block text-left"},e.createElement("div",null,e.createElement("button",{type:"button",className:"inline-flex justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-indigo-500",id:"menu-button","aria-expanded":i?"true":"false","aria-haspopup":"true",onClick:()=>{d(),setTimeout(()=>n(!1),1200)}},o.name,e.createElement("svg",{className:"-mr-1 ml-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},e.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.584l3.71-4.354a.75.75 0 111.14.976l-4.25 5a.75.75 0 01-1.14 0l-4.25-5a.75.75 0 01.02-1.06z",clipRule:"evenodd"})))),i?e.createElement("div",{className:"origin-top-right absolute right-0 mt-2 w-full rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:"-1"},e.createElement("div",{className:"py-1",role:"none"},e.createElement("a",{href:o.profileUrl,className:"text-gray-700 block px-4 py-2 text-sm hover:bg-gray-100",role:"menuitem",tabIndex:"-1",id:"menu-item-0"},"Perfil"),e.createElement("button",{className:"text-gray-700 block w-full text-left px-4 py-2 text-sm hover:bg-gray-100",role:"menuitem",tabIndex:"-1",id:"menu-item-3",onClick:()=>{K.post("/logout").then(()=>{window.location.href="/login"})}},"Cerrar sesión"))):null)}const A=u.memo(({text:o,typingSpeed:i=50})=>{const[n,d]=u.useState(""),[s,y]=u.useState(0);return u.useEffect(()=>{if(s<o.length){const a=setTimeout(()=>{d(E=>E+o[s]),y(E=>E+1)},i);return()=>clearTimeout(a)}},[s,o,i]),e.createElement("span",{className:"inline-block"},n)});A.displayName="Typewriter";function B({sedes:o,modalidades:i,csrfToken:n,actionUrl:d}){const[s,y]=u.useState({nombres_completos:"",tipo_documento:"CC",numero_documento:"",telefono_contacto:"",email:"",fecha_deseada:"",hora_deseada:"",sede_id:"",modalidad_id:"",motivo:"",observaciones:""}),[a,E]=u.useState({}),[_,C]=u.useState(!1),g=p=>{const{name:f,value:b}=p.target;y(t=>({...t,[f]:b})),a[f]&&E(t=>({...t,[f]:null}))},I=async p=>{p.preventDefault(),C(!0),E({});try{const f=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,Accept:"application/json"},body:JSON.stringify(s)}),b=await f.json();if(!f.ok){b.errors?E(b.errors):alert(b.message||"Error al registrar la cita"),C(!1);return}b.redirect&&(window.location.href=b.redirect)}catch(f){console.error("Error:",f),alert("Error al procesar la solicitud"),C(!1)}};return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registrar Nueva Cita"),e.createElement("p",{className:"text-gray-600"},"Complete el formulario para agendar su cita. No requiere autenticación.")),e.createElement("form",{onSubmit:I,className:"space-y-6"},e.createElement("div",{className:"border-b pb-6"},e.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-4"},"Datos Personales"),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres Completos *"),e.createElement("input",{type:"text",name:"nombres_completos",value:s.nombres_completos,onChange:g,placeholder:"Ej: Juan Pérez García",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.nombres_completos?"border-red-500":"border-gray-300"}`}),a.nombres_completos&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.nombres_completos[0])),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Documento *"),e.createElement("select",{name:"tipo_documento",value:s.tipo_documento,onChange:g,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.tipo_documento?"border-red-500":"border-gray-300"}`},e.createElement("option",{value:"CC"},"Cédula de Ciudadanía"),e.createElement("option",{value:"CE"},"Cédula de Extranjería"),e.createElement("option",{value:"TI"},"Tarjeta de Identidad"),e.createElement("option",{value:"PA"},"Pasaporte"),e.createElement("option",{value:"PE"},"Permiso Especial")),a.tipo_documento&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.tipo_documento[0])),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Número de Documento *"),e.createElement("input",{type:"text",name:"numero_documento",value:s.numero_documento,onChange:g,placeholder:"Ej: 1234567890",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.numero_documento?"border-red-500":"border-gray-300"}`}),a.numero_documento&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.numero_documento[0]))),e.createElement("div",{className:"grid grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono de Contacto *"),e.createElement("input",{type:"tel",name:"telefono_contacto",value:s.telefono_contacto,onChange:g,placeholder:"Ej: 3001234567",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.telefono_contacto?"border-red-500":"border-gray-300"}`}),a.telefono_contacto&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.telefono_contacto[0])),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Correo Electrónico *"),e.createElement("input",{type:"email",name:"email",value:s.email,onChange:g,placeholder:"Ej: usuario@ejemplo.com",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.email?"border-red-500":"border-gray-300"}`}),a.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.email[0])))),e.createElement("div",{className:"border-b pb-6"},e.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-4"},"Información de la Cita"),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha Deseada *"),e.createElement("input",{type:"date",name:"fecha_deseada",value:s.fecha_deseada,onChange:g,min:new Date().toISOString().split("T")[0],className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.fecha_deseada?"border-red-500":"border-gray-300"}`}),a.fecha_deseada&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.fecha_deseada[0])),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Hora Deseada *"),e.createElement("input",{type:"time",name:"hora_deseada",value:s.hora_deseada,onChange:g,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.hora_deseada?"border-red-500":"border-gray-300"}`}),a.hora_deseada&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.hora_deseada[0]))),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sede (Opcional)"),e.createElement("select",{name:"sede_id",value:s.sede_id,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"},e.createElement("option",{value:""},"Seleccione una sede..."),o.map(p=>e.createElement("option",{key:p.id,value:p.id},p.nombre," - ",p.ciudad)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Modalidad de Atención (Opcional)"),e.createElement("select",{name:"modalidad_id",value:s.modalidad_id,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"},e.createElement("option",{value:""},"Seleccione una modalidad..."),i.map(p=>e.createElement("option",{key:p.id,value:p.id},p.nombre))))),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Motivo de la Cita"),e.createElement("input",{type:"text",name:"motivo",value:s.motivo,onChange:g,placeholder:"Ej: Chequeo general de salud",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 ${a.motivo?"border-red-500":"border-gray-300"}`}),a.motivo&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.motivo[0])),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Observaciones Adicionales"),e.createElement("textarea",{name:"observaciones",value:s.observaciones,onChange:g,placeholder:"Información adicional que considere importante...",rows:"4",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none ${a.observaciones?"border-red-500":"border-gray-300"}`}),a.observaciones&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},a.observaciones[0]))),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"submit",disabled:_,className:"flex-1 bg-indigo-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200"},_?"Registrando...":"Registrar Cita"),e.createElement("button",{type:"button",onClick:()=>y({nombres_completos:"",tipo_documento:"CC",numero_documento:"",telefono_contacto:"",email:"",fecha_deseada:"",hora_deseada:"",sede_id:"",modalidad_id:"",motivo:"",observaciones:""}),className:"flex-1 bg-gray-300 text-gray-700 font-semibold py-3 px-4 rounded-lg hover:bg-gray-400 transition duration-200"},"Limpiar")),e.createElement("p",{className:"text-sm text-gray-500 text-center mt-4"},"Los campos marcados con * son obligatorios"))))}if(document.getElementById("registro-cita-root")){const o=document.getElementById("registro-cita-root"),i=JSON.parse(o.getAttribute("data-sedes")||"[]"),n=JSON.parse(o.getAttribute("data-modalidades")||"[]"),d=o.getAttribute("data-csrf"),s=o.getAttribute("data-action");w.createRoot(o).render(e.createElement(B,{sedes:i,modalidades:n,csrfToken:d,actionUrl:s}))}if(document.getElementById("dropdownComponent")){const o=w.createRoot(document.getElementById("dropdownComponent")),i=document.getElementById("dropdownComponent").getAttribute("data-nombre")||"nombre",n=document.getElementById("dropdownComponent").getAttribute("data-profile-url")||"/profile";o.render(e.createElement(D,{name:i,profileUrl:n}))}if(document.getElementById("typewriter")){const o=document.getElementById("typewriter"),i=o.getAttribute("text")||"Your trusted partner in clinical laboratory management";w.createRoot(o).render(e.createElement(A,{text:i,typingSpeed:50}))}if(document.getElementById("testComponent")){const o=document.getElementById("testComponent"),i=o.getAttribute("data-login-user"),n=o.getAttribute("data-register-user"),d=JSON.parse(o.getAttribute("data-auth-user"));w.createRoot(o).render(e.createElement(j,{loginUser:i,registerUser:n,authUser:d}))}document.getElementById("root")&&w.createRoot(document.getElementById("root")).render(e.createElement(O,null));
